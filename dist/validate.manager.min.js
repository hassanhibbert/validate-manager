"use strict";function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){function r(e){var r=Object.create(m),n={onSubmitHandler:null,onChangeHandler:null,formElement:null,validateOnChange:!0,resetFormOnSubmit:!0};return r.errorMessages={lettersOnly:"Please use letters only.",email:"Please enter a valid email address.",equalTo:"Please enter the same value.",digits:"Please enter a valid digit.",range:"Please enter a number between {0} and {1}",required:"This field is required.",minlength:"Please enter a minimum of {0} characters.",maxlength:"Please enter a maximum of {0} characters."},r.form={validationList:[],errorCollection:[]},r.boundOnChangeHandler=r.onChangeHandler.bind(r),r.boundOnSubmitHandler=r.onSubmitHandler.bind(r),r.isObject(e)&&(r.options=Object.assign(n,e),r.options.formName=r.options.formElement,r.options.formElement=t.forms[r.options.formElement]),r}!function(e){function t(e){return e&&"object"==(void 0===e?"undefined":_typeof(e))&&"[object RegExp]"!==Object.prototype.toString.call(e)&&"[object Date]"!==Object.prototype.toString.call(e)}function r(e){return Array.isArray(e)?[]:{}}function n(e,n){return n&&!0===n.clone&&t(e)?a(r(e),e,n):e}function i(e,r,i){var o=e.slice();return r.forEach(function(r,s){void 0===o[s]?o[s]=n(r,i):t(r)?o[s]=a(e[s],r,i):-1===e.indexOf(r)&&o.push(n(r,i))}),o}function o(e,r,i){var o={};return t(e)&&Object.keys(e).forEach(function(t){o[t]=n(e[t],i)}),Object.keys(r).forEach(function(s){o[s]=t(r[s])&&e[s]?a(e[s],r[s],i):n(r[s],i)}),o}function a(e,t,r){var a=Array.isArray(t),s=r||{arrayMerge:i},l=s.arrayMerge||i;return a?Array.isArray(e)?l(e,t,r):n(t,r):o(e,t,r)}a.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw Error("first argument should be an array with at least two elements");return e.reduce(function(e,r){return a(e,r,t)})},e.deepmerge=e.deepmerge||a}(window);var n=Object.prototype,i=n.toString,o=n.hasOwnProperty,a=function(e,t){return Object.assign(Object.create(e),t)},s={insertAfter:function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},html:function(e,t){e.innerHTML=t},removeNode:function(e){e.parentNode.removeChild(e)},exists:function(e){return t.querySelectorAll(e).length>0},isBoolean:function(e){return"[object Boolean]"===i.call(e)},isNodeList:function(e){return"[object RadioNodeList]"===i.call(e)},isObject:function(e){return"[object Object]"===i.call(e)},isFunction:function(e){return"[object Function]"===i.call(e)},isString:function(e){return"[object String]"===i.call(e)},getCheckedValues:function(e){return[].concat(_toConsumableArray(e)).filter(function(e){return e.checked}).map(function(e){return e.value})},first:function(e){return e.length>0?e[0]:e},flatten:function(e){var t;return(t=[]).concat.apply(t,_toConsumableArray(e))},removeClass:function(e,t){if(-1!=e.className.indexOf(t)){var r=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(r," ").trim()}},addClass:function(e,t){-1===e.className.indexOf(t)&&(""!=e.className&&(t=" "+t),e.className+=t)},getValidationRulesFromDOM:function(e){var t=this;return[].concat(_toConsumableArray(e)).reduce(function(e,r){var n=t.parseAttributes(r);return Object.keys(n).length&&(o.call(e,r.name)||(e[r.name]=n,e[r.name].fieldName=r.name)),e},{})},camelCase:function(e,t){return e.indexOf(t)<0?e:e.split(t).reduce(function(e,t,r){var t=r>0?t.charAt(0).toUpperCase()+t.slice(1):t;return e.push(t),e},[]).join("")},parseAttributes:function(e){var t=this;return[].concat(_toConsumableArray(e.attributes)).reduce(function(e,r){if(r.name.indexOf("data-vm-")>=0){var n=r.name.replace("data-vm-",""),i=t.camelCase(n,"-");try{var o=JSON.parse(r.value)}catch(e){var o=r.value}"required"===i?e[i]=o:e.rules?e.rules[i]=o:(e.rules={},e.rules[i]=o)}return e},{})},formatStringTemplate:function(){for(var e=this,t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").replace(/{(.*?)}/g,function(t,n){return Array.isArray(r[n])&&(r=e.flatten(r)),r[n]})},mergeRules:function(e,t){var r=deepmerge(t,e);return Object.keys(r).map(function(e){return r[e]})}},l=a(s,{required:function(e){return this.isNodeList(e)?[].concat(_toConsumableArray(e)).some(function(e){return e.checked}):!(0===e.length||""===e.trim()||null===e)},range:function(e,t){return parseInt(e)>=t[0]&&parseInt(e)<=t[1]},digits:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},lettersOnly:function(e){return/^[a-z]+$/i.test(e)},maxlength:function(e,t){return this.isNodeList(e)?this.getCheckedValues(e).length<=t:e.length<=t},minlength:function(e,t){return this.isNodeList(e)?this.getCheckedValues(e).length>=t:e.length>=t},equalTo:function(e,t,r){if(r[t]){return e===r[t].value}throw new Error('Could not find a form element with the name "'+t+'"')},email:function(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}}),u=a(l,{isItemInErrorCollection:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.form.errorCollection.filter(function(n){return r?n.id===t.id&&e===n.rule:n.id===t.id}).length>0},isErrorCollectionEmpty:function(){return 0===this.form.errorCollection.length},addToErrorCollection:function(e,t){this.isItemInErrorCollection(e,t)||this.form.errorCollection.push({id:t.id,rule:e,message:t.error[e]})},removeFromErrorCollection:function(e,t){this.isItemInErrorCollection(e,t)&&(this.form.errorCollection=this.form.errorCollection.filter(function(r){return t.id!==r.id&&e!==r.rule}))}}),c=a(u,{init:function(){this.options.validateOnChange&&this.options.formElement.addEventListener("change",this.boundOnChangeHandler,!1),this.options.formElement&&this.options.formElement.addEventListener("submit",this.boundOnSubmitHandler,!1)},destroy:function(){this.options.validateOnChange&&this.options.formElement.removeEventListener("change",this.boundOnChangeHandler,!1),this.options.formElement&&this.options.formElement.removeEventListener("submit",this.boundOnSubmitHandler,!1)},onSubmitHandler:function(e){var t=this;e.preventDefault(),this.validateRequiredFields(function(r){t.isFunction(t.options.onSubmitHandler)?t.options.onSubmitHandler(e,r,t.options.formElement):t.options.formElement.submit(),t.options.resetFormOnSubmit&&t.options.formElement.reset()})},onChangeHandler:function(e){e.preventDefault(),this.validateField(e.target),this.isFunction(this.options.onChangeHandler)&&this.options.onChangeHandler(e,e.target,this.options.formElement)},validateField:function(e){var t=this,r=this.form.validationList.filter(function(r){var n=t.isNodeList(e)?t.first(e).name:e.name;return r.fieldName===n});r=this.first(r),Object.keys(r.rules).some(function(e){var n=t[e].bind(t),i=t.isNodeList(r.element)?r.element:r.element.value,o=t.isBoolean(r.rules[e])?void 0:r.rules[e];if(!t.isFunction(n))throw new Error('"'+e+'" is not a valid rule.');var a=r.rules[e]&&n(i,o,t.options.formElement);return a?t.removeFromErrorCollection(e,r):t.addToErrorCollection(e,r),t.isItemInErrorCollection(e,r)?t.showError(r.id,r.error[e]):t.isItemInErrorCollection(e,r,!1)||t.hideError(r.id),!a})},buildErrorPlaceholders:function(){var e=this;this.form.validationList.forEach(function(r){var n=t.createElement("div"),i=r.element;if(n.className="error-message",n.id="error-mgn-"+r.id,e.isNodeList(i)){i[i.length-1].parentNode.appendChild(n)}else r.element.parentNode.appendChild(n)})},updateList:function(e){var t=this;return e.map(function(e,r){Object.assign(e,{id:r+"-"+t.options.formName,element:t.options.formElement[e.fieldName]});var n=o.call(e,"rules"),i=o.call(e,"required");n||(e.rules={}),i&&Object.assign(e.rules,{required:e.required});var a=Object.keys(e.rules);return e.error={},a.forEach(function(r){var n=o.call(e.error,r),i=e.rules[r],a=t.isBoolean(i);n||(e.error[r]=a?t.errorMessages[r]:t.formatStringTemplate(t.errorMessages[r],i)),o.call(e,"message")&&e.message[r]&&(e.error[r]=a?e.message[r]:t.formatStringTemplate(e.message[r],i))}),delete e.message,delete e.required,e})},showError:function(e,r){var n=t.querySelector("#error-mgn-"+e);this.html(n,r),this.addClass(n,"error-message_show")},hideError:function(e){var r=t.querySelector("#error-mgn-"+e);this.removeClass(r,"error-message_show")},getAllValues:function(){var e=this;return this.form.validationList.reduce(function(t,r){return t[r.fieldName]=e.isNodeList(r.element)?e.getCheckedValues(r.element):r.element.value,t},{})},getRequiredFields:function(){return this.form.validationList.filter(function(e){return o.call(e.rules,"required")}).map(function(e){return e.element})},validateRequiredFields:function(e){var t=this;this.getRequiredFields().forEach(function(e){t.validateField(e)}),this.isErrorCollectionEmpty()&&this.isFunction(e)&&e(this.getAllValues())}}),m=a(c,{validate:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.options.formElement)throw new Error('Could not find a form element with the name "'+this.options.formName+'"');var t=this.getValidationRulesFromDOM(this.options.formElement),r=this.mergeRules(e,t);this.form.validationList=this.updateList(r),this.buildErrorPlaceholders(),this.init()},addMethod:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])&&o.call(this,e))throw new Error("Method '"+e+"' is already use.");this[e]=t,this.errorMessages[e]=r}});e.ValidateManager=e.ValidateManager||r}(window,document);